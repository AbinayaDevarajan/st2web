<div class="st2-panel" ng-class="{'st2-panel--slide': $root.state.includes('*.details')}">

  <div class="st2-panel__view st2-actions">
    <div class="st2-panel__scroller">

      <div class="st2-panel__toolbar">
        <div class="st2-panel__toolbar-title">
          Actions
        </div>

        <div class="st2-panel__toolbar-search">
          <form>
            <input type="search"
              class="st2-panel__search-bar"
              placeholder="Search">
          </form>
        </div>
      </div>

      <div class="st2-flex-table" ng-repeat="(name, list) in groups">
        <div class="st2-flex-table__caption">
          <h2 class="st2-flex-table__caption-title">{{ name }}</h2>
        </div>

        <div class="st2-flex-table__header">
          <div class="st2-flex-table__column st2-actions__column-name">Machine Name</div>
          <div class="st2-flex-table__column st2-actions__column-type">Human-friendly Name</div>
          <div class="st2-flex-table__column st2-actions__column-desc">Description</div>
        </div>

        <div class="st2-flex-table__row"
            ng-class-odd="'st2-flex-table__row--odd'"
            ng-class-even="'st2-flex-table__row--even'"
            ng-repeat="action in list"
            ng-click="$root.state.go('^.summary', {id: action.id, page: $root.page})">
          <div class="st2-flex-table__column st2-actions__column-name">{{ action.name }}</div>
          <div class="st2-flex-table__column st2-actions__column-type">{{ action.runner_type }}</div>
          <div class="st2-flex-table__column st2-actions__column-desc">{{ action.description }}</div>
        </div>
      </div>

    </div>

    <div class="st2-panel__back-button"
      ng-click="$root.state.go('^.summary', {id: action.id, page: $root.page})">
    </div>

  </div>

  <div class="st2-summary">

    <div class="st2-summary__heading">
      <h2 class="st2-summary__heading-title">Summary</h2>
      <button class="st2-forms__button" title="Details"
          ng-click="$root.state.go('^.details', {id: action.id, page: $root.page})"
          ng-if="!$root.state.includes('*.details')">
        Details
      </button>
      <button class="st2-forms__button" title="Details"
          ng-click="$root.state.go('^.summary', {id: action.id, page: $root.page})"
          ng-if="$root.state.includes('*.details')">
        &lt;- Back
      </button>
    </div>

    <dl class="st2-summary__body">
      <dt class="st2-summary__body-label">Name</dt>
      <dd class="st2-summary__body-value">{{ action.name }}</dd>

      <dt class="st2-summary__body-label">Description</dt>
      <dd class="st2-summary__body-value">{{ action.description }}</dd>

      <dt class="st2-summary__body-label">Latest Execution Status</dt>
      <dd class="st2-summary__body-value">
        <span class="st2-label"
          status="_.last(executions).status"
          ng-if="executions.length">
        </span>
        <span ng-if="!executions.length">
          This action was never executed before
        </span>
      </dd>
    </dl>

  </div>

</div>

<div class="st2-details">
  <div class="st2-panel__scroller">

    <div class="st2-details__panel">
      <div class="st2-details__panel-heading">
        <h2 class="st2-details__panel-title">Parameters</h2>
      </div>
      <div class="st2-details__panel-body">
        <form role="form" class="st2-details__form"
            ng-submit="runAction(action.name, payload)">
          <div class="st2-details__panel-message"
              ng-if="_.isEmpty(action.parameters)">
            Action has no parameters
          </div>
          <div class="st2-auto-form"
            spec="action.parameters"
            result="payload">
          </div>
          <button type="submit" class="st2-forms__button">Run</button>
        </form>
      </div>
    </div>

    <div class="st2-details__panel">
      <div class="st2-details__panel-heading">
        <h2 class="st2-details__panel-title">
          Executions
          <i class="st2-details__reload-button st2-icon__reload"
            ng-class="{
              'animate-spin': inProgress,
              'st2-details__reload-button--in-progress': inProgress
            }"
            ng-click="inProgress || reloadExecutions(action.id)"></i>
        </h2>
      </div>
      <div class="st2-details__panel-body">
        <table class="st2-details__table">
          <thead>
            <tr>
              <th>Time</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="execution in executions | orderBy:'start_timestamp':true | limitTo:5" ng-class-odd="'st2-details__table-row--odd'" ng-class-even="'st2-details__table-row--even'" class="st2-details__table-row">
              <td>{{ execution.start_timestamp | date:'medium' }}</td>
              <td><div class="st2-label" status="execution.status"></div></td>
            </tr>
          </tbody>
        </table>
        <a class="st2-forms__button"
            ui-sref="history.list({action_id: action.id})">
          See all executions
        </a>
      </div>
    </div>

    <div class="st2-details__panel"
        ng-if="actionHasFile(action)">
      <div class="st2-details__panel-heading">
        <h2 class="st2-details__panel-title">File</h2>
      </div>
      <div class="st2-details__panel-body">
        <pre class="st2-details__well">{{ file }}</pre>
      </div>
    </div>

  </div>
</div>
